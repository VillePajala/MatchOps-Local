# Layer 2 — Step 2.4: HomePage Reduction via View‑Models

Goal
- Reduce HomePage coupling and prop explosion by introducing small, typed view‑models first, with zero runtime behavior change.

Scope (this series)
- GameContainer: introduce `GameContainerViewModel` and an adapter that derives it from current HomePage state.
- Keep GameContainer backwards compatible initially (accept both old props and the view‑model) to enable incremental migration.
- Add targeted tests and manual checks; run CI (lint/types/tests/build) each microstep.

Microsteps
1) 2.4.0 Types + Adapter (no runtime change)
   - Add `src/viewModels/gameContainer.ts` with interfaces and a `buildGameContainerViewModel()` function.
   - Unit tests for adapter with representative fixtures.
   - Wire nothing yet; ship types + tests only.

2) 2.4.1 HomePage → build + pass view‑model (keep old props)
   - HomePage constructs the view‑model and passes it alongside existing props to GameContainer.
   - GameContainer keeps using old props; no UI change.
   - Add a smoke test ensuring render remains stable.

3) 2.4.2 GameContainer consumes view‑model (feature‑flagged)
   - Add a guarded path in GameContainer to read from the view‑model for a small, isolated subset (e.g., player bar read‑only data).
   - Keep old props as fallback; parity test verifies outputs are identical.

4) 2.4.3 Remove duplicated props for the subset
   - Remove only those props replaced in 2.4.2; broaden usage in later PRs.

Non‑Goals (defer to later PRs)
- FieldContainer view‑model, `useNewGameFlow` parameter grouping, and reducer consolidation for other modals.

Regression Tests (scoped)
- GameContainer props parity for the migrated subset.
- Smoke test for HomePage render with view‑model present.

Manual Checklist
- Load Game, New Game, and Stats modals still open smoothly (Layer 1 behaviors intact).
- Player bar, field placements, and control bar still function.
- PWA paths: open offline, cached translations load.

Risks & Mitigations
- Risk: Silent divergence between old props and view‑model. Mitigate with parity assertions in tests.
- Risk: Large diffs. Mitigate by limiting the first migration to a tiny subset.

Rollback
- Revert the GameContainer view‑model usage commit; adapter/types are additive and safe to keep.

